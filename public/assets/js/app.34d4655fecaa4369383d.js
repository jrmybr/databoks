webpackJsonp([1],{121:function(t,e,n){"use strict";function a(t){n(122)}var r=n(58),o=n(124),i=n(23),s=a,u=i(r.a,o.a,!1,s,null,null);e.a=u.exports},122:function(t,e){},124:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],o={render:a,staticRenderFns:r};e.a=o},126:function(t,e,n){"use strict";function a(t){n(127)}var r=n(60),o=n(128),i=n(23),s=a,u=i(r.a,o.a,!1,s,null,null);e.a=u.exports},127:function(t,e){},128:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"home-cpn"}},[n("h1",[t._v(" Welcome ")]),t._v(" "),n("button",{on:{click:function(e){t.onClick()}}},[t._v("Login")])])},r=[],o={render:a,staticRenderFns:r};e.a=o},129:function(t,e,n){"use strict";function a(t){n(130)}var r=n(61),o=n(137),i=n(23),s=a,u=i(r.a,o.a,!1,s,null,null);e.a=u.exports},130:function(t,e){},137:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hello"},[t.isAuthenticated?t._e():n("form",{on:{submit:function(e){e.preventDefault(),t.onSubmit(t.email,t.password,t.event)}}},[n("div",{},[t._v("\n      "+t._s(t.isAuthenticated)+" "+t._s(t.errors)+"\n    ")]),t._v(" "),n("fieldset",{staticClass:"form-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control form-control-lg",attrs:{type:"text",placeholder:"Email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),t._v(" "),n("fieldset",{staticClass:"form-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control form-control-lg",attrs:{type:"password",placeholder:"Password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),n("button",{staticClass:"btn btn-lg btn-primary pull-xs-right"},[t._v("\n      Sign in\n    ")])]),t._v(" "),t.isAuthenticated?n("div",[n("div",[t._v(t._s(t.currentUser.username)+" is connected")]),t._v(" "),n("button",{staticClass:"btn btn-lg btn-primary pull-xs-right",on:{click:function(e){t.onLogout()}}},[t._v("\n      Log out\n    ")])]):t._e()])},r=[],o={render:a,staticRenderFns:r};e.a=o},138:function(t,e,n){"use strict";function a(t){n(139)}var r=n(63),o=n(140),i=n(23),s=a,u=i(r.a,o.a,!1,s,null,null);e.a=u.exports},139:function(t,e){},140:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hello"},[n("div",[t._v(" Je bent in Hello component ")]),t._v(" "),n("div",[t._v(t._s(t.currentUser.username)+" is connected")]),t._v(" "),n("button",{staticClass:"btn btn-lg btn-primary pull-xs-right",on:{click:function(e){t.onLogout()}}},[t._v("\n      Log out\n    ")])])},r=[],o={render:a,staticRenderFns:r};e.a=o},141:function(t,e,n){"use strict";var a=n(21),r=n(35),o=n(142),i=n.n(o),s=n(143);a.a.use(r.a),e.a=new r.a.Store({modules:{home:i.a,auth:s.a}})},142:function(t,e){},143:function(t,e,n){"use strict";var a,r,o=n(144),i=n.n(o),s=n(40),u=n.n(s),c=n(65),l=n(71),h=n(24),d=n(168),f=n(169),m={errors:null,user:{},isAuthenticated:!!l.a.getToken(),auth:new f.a},p={currentUser:function(t){return t.user},isAuthenticated:function(t){return t.isAuthenticated}},v=(a={},i()(a,h.b,function(t,e){console.log(this.state.auth),this.state.auth.login()}),i()(a,h.c,function(t){t.commit(d.a)}),i()(a,h.d,function(t,e){return new u.a(function(n,a){c.a.post("users",{user:e}).then(function(e){var a=e.data;t.commit(d.b,a.user),n(a)}).catch(function(e){var n=e.response;t.commit(d.c,n.data.errors)})})}),i()(a,h.a,function(t){l.a.getToken()?(c.a.setHeader(),c.a.get("user").then(function(e){var n=e.data;t.commit(d.b,n.user)}).catch(function(e){var n=e.response;t.commit(d.c,n.data.errors)})):t.commit(d.a)}),i()(a,h.e,function(t,e){var n=e.email,a=e.username,r=e.password,o=e.image,i=e.bio,s={email:n,username:a,bio:i,image:o};return r&&(s.password=r),c.a.put("user",s).then(function(e){var n=e.data;return t.commit(d.b,n.user),n})}),a),g=(r={},i()(r,d.c,function(t,e){t.errors=e}),i()(r,d.b,function(t,e){t.isAuthenticated=!0,t.user=e,t.errors={},l.a.saveToken(t.user.token)}),i()(r,d.a,function(t){t.isAuthenticated=!1,t.user={},t.errors={},l.a.destroyToken()}),r);e.a={state:m,actions:v,mutations:g,getters:p}},167:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var a="http://localhost:8000/api/"},168:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return r}),n.d(e,"c",function(){return o});var a="logOut",r="setUser",o="setError"},169:function(t,e,n){"use strict";var a=n(170),r=n.n(a),o=n(172),i=n.n(o),s=n(173),u=n.n(s),c=n(174),l=n.n(c),h=n(208),d=n(209),f=n.n(d),m=n(59),p=function(){function t(){i()(this,t),this.authenticated=this.isAuthenticated(),this.authNotifier=new f.a,this.auth0=new l.a.WebAuth({domain:h.a.domain,clientID:h.a.clientId,redirectUri:h.a.callbackUrl,audience:"https://databoks-test.eu.auth0.com/userinfo",responseType:"token id_token",scope:"openid"}),this.login=this.login.bind(this),this.setSession=this.setSession.bind(this),this.logout=this.logout.bind(this),this.isAuthenticated=this.isAuthenticated.bind(this)}return u()(t,[{key:"login",value:function(){this.auth0.authorize()}},{key:"handleAuthentication",value:function(){var t=this;this.auth0.parseHash(function(e,n){n&&n.accessToken&&n.idToken?(t.setSession(n),m.a.replace("/user")):e&&(m.a.replace("/"),console.log(e),alert("Error: "+e.error+". Check the console for further details."))})}},{key:"setSession",value:function(t){var e=r()(1e3*t.expiresIn+(new Date).getTime());localStorage.setItem("access_token",t.accessToken),localStorage.setItem("id_token",t.idToken),localStorage.setItem("expires_at",e),this.authNotifier.emit("authChange",{authenticated:!0})}},{key:"logout",value:function(){localStorage.removeItem("access_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),this.userProfile=null,this.authNotifier.emit("authChange",!1),m.a.replace("/")}},{key:"isAuthenticated",value:function(){var t=JSON.parse(localStorage.getItem("expires_at"));return(new Date).getTime()<t}},{key:"getUserProfile",value:function(t){var e=localStorage.getItem("access_token");return e?this.auth0.client.userInfo(e,t):null}}],[{key:"getAuthToken",value:function(){return localStorage.getItem("access_token")}},{key:"authenticated",value:function(){var t=JSON.parse(localStorage.getItem("expires_at"));return(new Date).getTime()<t}}]),t}();e.a=p},208:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var a={clientId:"7DaP9afiYncYSSfWXj6UAj5HmV7_HIDY",domain:"databoks-test.eu.auth0.com",callbackUrl:"http://localhost:8000/#/user",apiUrl:"http://localhost:8000/api"}},24:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return r}),n.d(e,"c",function(){return o}),n.d(e,"d",function(){return i}),n.d(e,"e",function(){return s});var a="checkAuth",r="login",o="logout",i="register",s="updateUser"},58:function(t,e,n){"use strict";e.a={name:"App"}},59:function(t,e,n){"use strict";var a=n(21),r=n(125),o=n(126),i=n(129),s=n(138);a.a.use(r.a),e.a=new r.a({routes:[{path:"/",component:o.a,children:[],meta:{requiresAuth:!1}},{path:"/user",name:"user",component:s.a,meta:{requiresAuth:!0}},{path:"/login",name:"login",component:i.a,meta:{requiresAuth:!1}}]})},60:function(t,e,n){"use strict";e.a={name:"home",data:function(){return{untruc:!1}},methods:{onClick:function(){this.$router.push({path:"/login"})}}}},61:function(t,e,n){"use strict";var a=n(62),r=n.n(a),o=n(35),i=n(24);e.a={name:"login",data:function(){return{email:null,password:null}},methods:{onSubmit:function(t,e){var n=this;this.$store.dispatch(i.b,{email:t,password:e}).then(function(){n.$router.push({path:"/user"})}),event.target.reset(),this.email=null,this.password=null},onLogout:function(){var t=this;this.$store.dispatch(i.c).then(function(){t.$router.push({path:"/"})})}},computed:r()({},Object(o.c)({errors:function(t){return t.auth.errors}}),Object(o.b)(["isAuthenticated","currentUser"]))}},63:function(t,e,n){"use strict";var a=n(62),r=n.n(a),o=n(35),i=n(24);e.a={name:"hello",data:function(){return{email:null,password:null}},methods:{onSubmit:function(t,e){var n=this;this.$store.dispatch(i.b,{email:t,password:e}).then(function(){n.$router.push({path:"/"})})},onLogout:function(){var t=this;this.$store.dispatch(i.c).then(function(){t.$router.push({path:"/"})})}},computed:r()({},Object(o.c)({errors:function(t){return t.auth.errors}}),Object(o.b)(["isAuthenticated","currentUser"]))}},65:function(t,e,n){"use strict";var a=n(21),r=n(147),o=n.n(r),i=n(166),s=n.n(i),u=n(71),c=n(167),l={init:function(){a.a.use(s.a,o.a),a.a.axios.defaults.baseURL=c.a},setHeader:function(){a.a.axios.defaults.headers.common.Authorization="Token "+u.a.getToken()},query:function(t,e){return a.a.axios.get(t,e).catch(function(t){throw new Error("[RWV] ApiService "+t)})},get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return a.a.axios.get(t+"/"+e).catch(function(t){throw new Error("[RWV] ApiService "+t)})},post:function(t,e){return a.a.axios.post(""+t,e)},update:function(t,e,n){return a.a.axios.put(t+"/"+e,n)},put:function(t,e){return a.a.axios.put(""+t,e)},delete:function(t){return a.a.axios.delete(t).catch(function(t){throw new Error("[RWV] ApiService "+t)})}};e.a=l},71:function(t,e,n){"use strict";e.a={getToken:function(){return window.localStorage.getItem("id_token")},saveToken:function(t){window.localStorage.setItem("id_token",t)},destroyToken:function(){window.localStorage.removeItem("id_token")}}},87:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(40),r=n.n(a),o=n(21),i=n(121),s=n(59),u=n(141),c=n(24),l=n(65);o.a.config.productionTip=!1,l.a.init(),s.a.beforeEach(function(t,e,n){return r.a.all([u.a.dispatch(c.a)]).then(function(e){!1===t.meta.requiresAuth|t.meta.requiresAuth&u.a.getters.isAuthenticated?n():n("/")})}),new o.a({el:"#app",router:s.a,store:u.a,template:"<App/>",components:{App:i.a}})}},[87]);
//# sourceMappingURL=app.34d4655fecaa4369383d.js.map